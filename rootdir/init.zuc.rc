on init
    # Disable UFS powersaving
    write /sys/devices/soc/${ro.boot.bootdevice}/clkscale_enable 0
    write /sys/devices/soc/${ro.boot.bootdevice}/clkgate_enable 0
    write /sys/devices/soc/${ro.boot.bootdevice}/hibern8_on_idle_enable 0
    write /sys/module/lpm_levels/parameters/sleep_disabled Y
	
    # Less throttling, more experience (CPU)
    write /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor "electroutil"
    write /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq 2016000
    chmod 777 /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq
    write /sys/module/msm_hotplug/msm_enabled 1
    write /sys/module/msm_hotplug/boost_lock_duration 1500
    write /sys/module/msm_hotplug/cpus_boosted 5
    write /sys/module/msm_hotplug/fast_lane_load 100
    write /sys/module/msm_hotplug/lock_duration 500
    write /sys/module/msm_hotplug/max_cpus_online 8
    write /sys/module/msm_hotplug/min_cpus_online 4
    write /sys/module/msm_hotplug/offline_load 15
    write /sys/module/msm_hotplug/update_rates 1
    write /sys/module/msm_hotplug/max_cpus_online_susp 2
	
# Less throttling, more experience (GPU)
    # Adreno Idler
    write /sys/module/adreno_idler/parameters/adreno_idler_active 1
    write /sys/module/adreno_idler/parameters/adreno_idler_downdifferential 10
    write /sys/module/adreno_idler/parameters/adreno_idler_idlewait 30
    write /sys/module/adreno_idler/parameters/adreno_idler_idleworkload 2000
	
    #GPU
    write /sys/class/devfreq/1c00000.qcom,kgsl-3d0/max_freq 650000000

	
on property:sys.boot_completed=1
    # Enable UFS powersaving
    write /sys/devices/soc/${ro.boot.bootdevice}/clkscale_enable 1
    write /sys/devices/soc/${ro.boot.bootdevice}/clkgate_enable 1
    write /sys/devices/soc/${ro.boot.bootdevice}/hibern8_on_idle_enable 1
    write /sys/module/lpm_levels/parameters/sleep_disabled N
on charger
    # Enable UFS powersaving
    write /sys/devices/soc/${ro.boot.bootdevice}/clkscale_enable 1
    write /sys/devices/soc/${ro.boot.bootdevice}/clkgate_enable 1
    write /sys/devices/soc/${ro.boot.bootdevice}/hibern8_on_idle_enable 1
    write /sys/class/typec/port0/port_type sink
    write /sys/module/lpm_levels/parameters/sleep_disabled N

on fs
    mount_all ./fstab.qcom --early

    # boot time fs tune
    write /sys/block/sda/queue/iostats 0
    write /sys/block/sda/queue/scheduler bfq
    write /sys/block/sda/queue/iosched/slice_idle 0
    write /sys/block/sda/queue/read_ahead_kb 2048
    write /sys/block/sda/queue/nr_requests 256
    write /sys/block/dm-0/queue/read_ahead_kb 2048
    write /sys/block/dm-1/queue/read_ahead_kb 2048

# Run post-boot script after Qualcomm's post_boot shell script
on property:init.svc.qcom-post-boot=stopped
    write /sys/devices/platform/kcal_ctrl.0/kcal "192 192 192"
    write /sys/kernel/sound_control/headphone_gain "0 0"
    write /sys/kernel/sound_control/speaker_gain "0"

# VM
    write /proc/sys/vm/dirty_ratio "40"
    write /proc/sys/vm/dirty_background_ratio "10"
    write /proc/sys/vm/swappiness "40"
    write /proc/sys/vm/overcommit_ratio "30"

# FP_BOOST
    write /sys/kernel/fp_boost/enabled 1

on property:sys.boot_completed=1
   # Enable ZRAM on boot_complete
   swapon_all /vendor/etc/fstab.${ro.hardware}
